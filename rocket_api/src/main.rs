
#![feature(decl_macro)]

#[macro_use]
extern crate diesel;
#[macro_use]
extern crate serde_derive;
#[macro_use]
extern crate serde_json;
#[macro_use]
extern crate rocket_codegen;
#[macro_use]
extern crate rocket_contrib;


mod models;
mod schema;
mod db;
mod static_files;
mod routes;

use diesel::{Connection, PgConnection};
use dotenv::dotenv;
use r2d2::PooledConnection;
use r2d2_diesel::ConnectionManager;
use models::*;
use crate::schema::parents::columns::first_name;


fn main() {
    rocket().launch();
}

fn rocket() -> rocket::Rocket {

    dotenv().ok();
    let db_url = std::env::var("DATABASE_URL").expect("set DATABASE_URL");
    let pool = db::init_pool(db_url);

    file_dummy(pool.get().unwrap());
    rocket::ignite()
        .manage(pool)
        .mount("/api/v1", routes![routes::parents,routes::insert_parent,routes::get_parent,routes::update_parent,routes::delete_parent,routes::delete_all_parents])
        .mount("/", routes![static_files::index,static_files::all])
}

fn file_dummy(conn:PooledConnection<ConnectionManager<PgConnection>>){
    let parent=NewParent::new(
      "justice".to_string(),
        "eli".to_string(),
        "justic eli".to_string(),
        "+254793506871".to_string(),
        "nairobi".to_string(),
        "jobless".to_string(),
        "22".to_string(),
        "male".to_string(),
        "software engineer".to_string(),
        "justelonelin@gmail.com".to_string(),
        "https://photo_mania".to_string(),
        "data:image/jpeg;base64,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".to_string(),

    );

    Parent::insert(parent,&conn);
}